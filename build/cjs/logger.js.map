{"version":3,"file":"logger.js","names":["_winston","_interopRequireDefault","require","_winstonElasticsearch","e","__esModule","default","esTransformer","logData","ElasticsearchTransformer","winstonLogger","elasticsearchNode","name","level","options","console","handleExceptions","json","colorize","elasticsearch","transformer","clientOpts","node","log","maxRetries","requestTimeout","sniffOnStart","esTransport","ElasticsearchTransport","logger","winston","createLogger","transports","Console","exitOnError","defaultMeta","service","exports"],"sources":["../../src/logger.ts"],"sourcesContent":["import { json, request } from 'express';\r\nimport winston, { log, Logger } from 'winston';\r\nimport {\r\n  ElasticsearchTransformer,\r\n  ElasticsearchTransport,\r\n  LogData,\r\n  TransformedData,\r\n} from 'winston-elasticsearch';\r\n\r\nconst esTransformer = (logData: LogData): TransformedData => {\r\n  return ElasticsearchTransformer(logData);\r\n};\r\n\r\nexport const winstonLogger = (\r\n  elasticsearchNode: string,\r\n  name: string,\r\n  level: string\r\n): Logger => {\r\n  const options = {\r\n    console: {\r\n      level,\r\n      handleExceptions: true,\r\n      json: false,\r\n      colorize: true,\r\n    },\r\n    elasticsearch: {\r\n      level,\r\n      transformer: esTransformer,\r\n      clientOpts: {\r\n        node: elasticsearchNode,\r\n        log: level,\r\n        maxRetries: 2,\r\n        requestTimeout: 10000,\r\n        sniffOnStart: false,\r\n      },\r\n    },\r\n  };\r\n  const esTransport: ElasticsearchTransport = new ElasticsearchTransport(\r\n    options.elasticsearch\r\n  );\r\n  const logger: Logger = winston.createLogger({\r\n    transports: [new winston.transports.Console(options.console), esTransport],\r\n    exitOnError: false,\r\n    defaultMeta: { service: name },\r\n  });\r\n  return logger;\r\n};\r\n"],"mappings":";;;;AACA,IAAAA,QAAA,GAAAC,sBAAA,CAAAC,OAAA;AACA,IAAAC,qBAAA,GAAAD,OAAA;AAK+B,SAAAD,uBAAAG,CAAA,WAAAA,CAAA,IAAAA,CAAA,CAAAC,UAAA,GAAAD,CAAA,KAAAE,OAAA,EAAAF,CAAA;AAE/B,MAAMG,aAAa,GAAIC,OAAgB,IAAsB;EAC3D,OAAO,IAAAC,8CAAwB,EAACD,OAAO,CAAC;AAC1C,CAAC;AAEM,MAAME,aAAa,GAAGA,CAC3BC,iBAAyB,EACzBC,IAAY,EACZC,KAAa,KACF;EACX,MAAMC,OAAO,GAAG;IACdC,OAAO,EAAE;MACPF,KAAK;MACLG,gBAAgB,EAAE,IAAI;MACtBC,IAAI,EAAE,KAAK;MACXC,QAAQ,EAAE;IACZ,CAAC;IACDC,aAAa,EAAE;MACbN,KAAK;MACLO,WAAW,EAAEb,aAAa;MAC1Bc,UAAU,EAAE;QACVC,IAAI,EAAEX,iBAAiB;QACvBY,GAAG,EAAEV,KAAK;QACVW,UAAU,EAAE,CAAC;QACbC,cAAc,EAAE,KAAK;QACrBC,YAAY,EAAE;MAChB;IACF;EACF,CAAC;EACD,MAAMC,WAAmC,GAAG,IAAIC,4CAAsB,CACpEd,OAAO,CAACK,aACV,CAAC;EACD,MAAMU,MAAc,GAAGC,gBAAO,CAACC,YAAY,CAAC;IAC1CC,UAAU,EAAE,CAAC,IAAIF,gBAAO,CAACE,UAAU,CAACC,OAAO,CAACnB,OAAO,CAACC,OAAO,CAAC,EAAEY,WAAW,CAAC;IAC1EO,WAAW,EAAE,KAAK;IAClBC,WAAW,EAAE;MAAEC,OAAO,EAAExB;IAAK;EAC/B,CAAC,CAAC;EACF,OAAOiB,MAAM;AACf,CAAC;AAACQ,OAAA,CAAA3B,aAAA,GAAAA,aAAA","ignoreList":[]}